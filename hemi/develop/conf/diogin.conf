// shell> ./develop -config conf/diogin.conf

stage {
	.logFile = %logsDir + "/develop-worker.log"

	// backends
	tcpsBackend "fpm" {
		.balancer = "roundRobin"
		.nodes    = (
			["address": "127.0.0.1:9000"],
			["address": "127.0.0.1:9000"],
		)
	}

	// apps
	app "diogin" {
		.hostnames = ("*")
		.webRoot   = %baseDir + "/apps/diogin/root"

		rule $hostname == "localhost" {
			fcgiAgent {
				.toBackend = "fpm"
				.keepConn  = true
			}
		}
		rule {
			dioginHandlet {}
			//wrapReviser {}
		}
	}

	// svcs
	svc "diogin" {
	}

	// servers
	httpxServer "main" {
		.forApps = ("diogin")
		.forSvcs = ("diogin")
		.address = ":4080"
	}
}
